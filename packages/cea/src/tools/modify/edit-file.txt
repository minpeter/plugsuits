### edit_file
**Purpose**: Hashline-native surgical edits with deterministic anchors

**When to use**:
- Modifying existing files (changing functions, fixing bugs)
- Applying anchored edits using `LINE#HASH` refs from `read_file`
- Inserting/replacing/deleting exact ranges without ambiguous matching

**Key features**:
- Hashline ops via `edits[]`: `replace`, `append`, `prepend`
- `expected_file_hash` stale check prevents edits on changed files

**Input contract**:
- `path` (required): target file path
- `edits` (required, min 1): list of hashline operations
- `expected_file_hash` (optional): file hash from latest `read_file`

**Operation rules**:
- `replace`: requires `pos` or `end` anchor (`LINE#HASH`)
- `append` / `prepend`: optional anchor; without anchor, insert at file boundary
- `lines: []` or `lines: null` on `replace` can be used for line deletion

**Failure handling**:
- Stale anchor/hash errors mean file changed; run `read_file` again and retry with fresh refs
- No-op edits are rejected to prevent silent failures

**DO NOT use shell commands**: Use this instead of `sed`, `awk`, or `perl -i`

**Example**:
```
edit_file({
  path: "config.ts",
  edits: [{ op: "replace", pos: "12#AB", lines: ["port: 8080"] }],
  expected_file_hash: "0a1b2c3d"
})
```
